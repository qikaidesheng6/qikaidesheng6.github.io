<!DOCTYPE html>
<html lang="en">

{% include head.html %}

<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    {% include nav.html %}
    {% include search.html %}

    {{ content }}

    {% include footer.html %}

    <!-- 音乐自动播放组件（路径改为 audio 文件夹） -->
    <audio id="backgroundMusic" loop preload="auto">
        <!-- 音频路径指向网站根目录下的 audio 文件夹 -->
        <source src="/audio/zhdap.mp3" type="audio/mpeg">
        <source src="/audio/zhdap.ogg" type="audio/ogg">
        <source src="/audio/zhdap.wav" type="audio/wav">
        <!-- 浏览器不支持 audio 标签时的降级提示 -->
        您的浏览器不支持音频播放，请升级浏览器
    </audio>

    <!-- 自动播放脚本（处理浏览器限制） -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const audio = document.getElementById('backgroundMusic');
            // 可选：设置默认音量（0-1之间，避免音量过大）
            audio.volume = 0.3; // 30% 音量，可根据需求调整

            // 方法1：尝试直接自动播放（部分浏览器支持）
            function playAudio() {
                audio.play().catch(error => {
                    console.log('直接自动播放失败，需要用户交互：', error);
                    // 方法2：监听用户首次交互后播放（兼容大部分浏览器）
                    document.addEventListener('click', initAudioPlay, { once: true });
                    document.addEventListener('touchstart', initAudioPlay, { once: true });
                });
            }

            // 用户交互后初始化播放
            function initAudioPlay() {
                audio.play().then(() => {
                    console.log('音乐开始播放');
                }).catch(error => {
                    console.log('用户交互后播放失败：', error);
                });
            }

            // 初始化播放
            playAudio();

            // 可选：页面可见性变化时处理播放状态
            document.addEventListener('visibilitychange', function() {
                if (document.visibilityState === 'visible' && audio.paused) {
                    playAudio();
                }
            });
        });
    </script>

<!-- Image to hack wechat -->
<img src="/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>